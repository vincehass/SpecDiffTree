# SpecDiffTree - Conservative Training (Apple Silicon MPS)
# Use if standard config produces NaN loss

experiment:
  name: "specdifftree_conservative"
  tags: ["specdifftree", "mps", "conservative", "stable"]
  notes: "Conservative settings for numerical stability"

dataset:
  name: "TSQA"
  task: "Multiple Choice Question Answering"
  num_samples_train: 6300
  num_samples_val: 630
  num_samples_test: 700

model:
  type: "OpenTSLMSP"
  llm_id: "meta-llama/Llama-3.2-1B"
  gradient_checkpointing: false
  lora:
    enabled: false

training:
  num_epochs: 30
  batch_size: 2  # Smaller for stability
  lr_encoder: 1.0e-4  # Lower learning rates
  lr_projector: 5.0e-5
  lr_base: 1.0e-4
  weight_decay: 1.0e-2
  grad_clip_norm: 0.5  # Stricter clipping
  warmup_fraction: 0.05  # More warmup
  early_stopping_patience: 5
  patch_size: 4

device:
  type: "mps"
  
evaluation:
  metrics: ["accuracy", "loss"]
  save_predictions: true

